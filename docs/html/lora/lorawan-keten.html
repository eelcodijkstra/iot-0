
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="nl">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>LoRaWan-keten &#8212; iot-0  documentatie</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/translations.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Zoeken" href="../search.html" />
    <link rel="next" title="Opdrachten" href="opdrachten.html" />
    <link rel="prev" title="LoRa-knopen" href="../lora.html" />

<script type="application/json" class="js-hypothesis-config">
{
"showHighlights": false
}
</script>
<script async src="https://hypothes.is/embed.js"></script>


  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="lorawan-keten">
<h1>LoRaWan-keten<a class="headerlink" href="#lorawan-keten" title="Permalink naar deze titel">¶</a></h1>
<div class="figure align-center" id="id1">
<a class="reference internal image-reference" href="../_images/IoT-publieke-gateway-11.png"><img alt="../_images/IoT-publieke-gateway-11.png" src="../_images/IoT-publieke-gateway-11.png" style="width: 600px;" /></a>
<p class="caption"><span class="caption-text">LoRaWan-keten met publieke gateway</span></p>
</div>
<ul class="simple">
<li>lora: best-effort pakketcommunicatie</li>
<li>pakket:</li>
<li>adressering:</li>
<li>payload: zo compact mogelijk; binaire codering</li>
<li>volgnummers: (detectie van verloren pakket)</li>
<li><dl class="first docutils">
<dt>gateway:</dt>
<dd><ul class="first last">
<li>protocol-conversie</li>
<li>metadata</li>
<li>onderhandeling met IoT-knoop</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>server:</dt>
<dd><ul class="first last">
<li>application:</li>
<li>device: (IoT-knoop)</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>toepassing: (bijv. dashboard)</dt>
<dd><ul class="first last">
<li>communicatie via mqtt</li>
<li>hoe gebeurt authenticatie van gebruiker?</li>
</ul>
</dd>
</dl>
</li>
</ul>
<div class="admonition-todo admonition" id="index-0">
<p class="first admonition-title">Te doen</p>
<ul class="last simple">
<li><dl class="first docutils">
<dt>LoRa radio: eigenschappen, regels voor gebruikers</dt>
<dd><ul class="first last">
<li>begrip payload</li>
<li>adressering</li>
<li>best-effort pakketcommunicatie</li>
</ul>
</dd>
</dl>
</li>
<li>LoRaWan netwerk: architectuur; div. aanbieders</li>
<li>TheThingsNetwork: wereldwijd LoRaWan netwerk</li>
<li>LoRa radio module: RFM95 (880 MHz)</li>
<li>LoRa radio module - driver (Arduino)</li>
<li>wat zijn typische LoRa-toepassingen?</li>
</ul>
</div>
<p>In dit hoofdstuk maken we kennis met LoRaWan: een netwerk voor IoT-knopen met een LoRa (long range) radio.
Deze LoRa radio biedt een groot bereik,tot enkele kilometers;
dit gaat ten koste van de bitrate en van het aantal berichten per uur, maximaal ca. 10-20.
We beschrijven eerst de eigenschappen van de LoRa radio,
vervolgens de opzet van een LoRaWan netwerk,
en daarna een speciale aanbieder van dit netwerk: TheThingsNetwork.</p>
<p>Tenslotte beschrijven we een aantal opdrachten en experimenten met voorgeconfigureerde LoRaWan-knopen.
Voor een beschrijving van de gebruikte onderdelen in meer detail verwijzen we weer naar IoT-2: IoT voor makers.</p>
<p>Typische toepassingen van LoRaWan</p>
<div class="section" id="lora-radio">
<h2>LoRa-radio<a class="headerlink" href="#lora-radio" title="Permalink naar deze titel">¶</a></h2>
<p>De LoRa-radio gebruikt de 868MHz band (tenminste, in Europa; elders worden ook 433MHz en 915MHz gebruikt).
Deze band kun je zonder vergunning gebruiken, mits je je houdt aan de volgende regels:</p>
<ul class="simple">
<li>een radio mag zenden met een maximaal vermogen van +20dB;</li>
<li>een radio mag maximaal 1% van de tijd zenden, (gemiddeld over een uur?)</li>
</ul>
<p>Zie:</p>
<p>(Ook de RFM69-radio gebruikt deze radioband, en heeft dezelfde beperkingen.)</p>
<p>Bij IoT-radio’s heb je te maken met een afweging tussen het bereik en de beschikbare bandbreedte (bitrate).
Bij de LoRa radio is gekozen voor een groot bereik, ten koste van de bitrate.</p>
<p>De afweging tussen bereik en bitrate wordt dynamisch gemaakt:
als een LoRa-radio voor het eerst verbinding zoekt met een LoRa gateway,
bepalen deze samen de beste verdeling tussen bereik en bitrate.
Een lage “spreading factor” (SF) geeft een hoge bitrate met een beperkt bereik.
Een hoge SF geeft een groter bereik, maar met een beperkte bitrate.
Elke volgende SF (tussen SF7 en SF12) geeft de helft van de bitrate van de vorige.</p>
<p>De <em>airtime</em> van een radio-bericht is de tijd dat dit bericht het radiokanaal gebruikt.
Gedurende het verzenden van een bericht kan het radiokanaal niet door anderen gebruikt worden.
Eenzelfde bericht neemt bij een volgende SF tweemaal zoveel airtime.
Een bericht dat bij SF7 10ms kost, neemt bij SF12 2^5 = 32 * 10 ms.</p>
<p>Het is dus belangrijk om bij een lage bitrate de berichten <em>zo kort mogelijk</em> te houden.
Een speciale binaire codering van sensorwaarden is (aanmerkelijk) korter dan een JSON-formaat.
(TheThingsNetwork heeft speciale voorzieningen voor de decodering van zo’n speciaal binair formaat.)</p>
<p>Een lage bitrate heeft nog een nadeel: de latency neemt erdoor toe.
Immers, de latency is tenminste even groot als de airtime.</p>
<p>De Sigfox-radio is een ander voorbeeld waarbij dezelfde keuze gemaakt is.
Voor Sigfox gelden de volgende regels/eigenschappen:</p>
<blockquote>
<div><ul class="simple">
<li>12 bytes upload (payload); frame 26 bytes;</li>
<li>8 bytes download (payload)</li>
<li>low bitrate: 100-600 bit/s (26*8 bits = 208 bits: ca. 2 sec per message)</li>
</ul>
</div></blockquote>
<p>Voor de radioband (880MHz) die LoRa gebruikt gelden de volgende regels:</p>
</div>
<div class="section" id="lorawan">
<h2>LoRaWan<a class="headerlink" href="#lorawan" title="Permalink naar deze titel">¶</a></h2>
<p>De LoRa-radio biedt alleen elementaire pakket-communicatie: voor het communiceren in een netwerk heb je nog een extra protocol daarboven nodig.
LoRaWan is het netwerk-protocol voor LoRa-radio’s.</p>
<p>Er zijn allerlei aanbieders voor LoRaWan-netwerken: via deze aanbieders kun je je eigen LoRaWan-knopen aansluiten op het internet.
Je kunt deze aanbieders vergelijken met de aanbieders van mobiele telefonie:
een aanbieder heeft verspreid over het land LoRaWan-gateways staan voor de communicatie met LoRaWan-knopen.
Deze gateways sturen de LoRa-berichten door naar de LoRaWan-servers, die zorgen voor de aansluiting op het internet.
LoRaWan-toepassingen communiceren met deze LoRaWan-servers.</p>
<div class="admonition-todo admonition" id="index-1">
<p class="first admonition-title">Te doen</p>
<ul class="last simple">
<li>Figuur van LoRaWan-keten.</li>
<li>LoRaWan - protocol stack</li>
<li>LoRaWan gateway: protocol-conversie (ook nog eens in de server?)</li>
</ul>
</div>
<p>Aanbieders van LoRaWan in Nederland:</p>
<ul class="simple">
<li>KPN</li>
<li>TheThingsNetwork</li>
</ul>
</div>
<div class="section" id="thethingsnetwork">
<h2>TheThingsNetwork<a class="headerlink" href="#thethingsnetwork" title="Permalink naar deze titel">¶</a></h2>
<p>TheThingsNetwork is een speciale LoRaWan-aanbieder: het netwerk is opgebouwd door een <em>community</em>.
Het netwerk is gratis te gebruiken.
Er zijn overal in de wereld, en vooral in Nederland, lokale <em>communities</em> die ervaringen uitwisselen,
en die zorgen voor de lokale LoRaWan-dekking door eigen gateways aan te bieden.</p>
<p>Voor TheThingsNetwork gelden nog een extra regel:</p>
<ul class="simple">
<li>de totale duur (airtime) van de berichten van een radio (IoT-knoop) mag per dag niet meer dan 30 s. zijn.</li>
</ul>
<p>Deze beperking is bedoeld om het TTN-netwerk op een eerlijke manier te gebruiken (“fair use”):
iedereen kan dit netwerk gratis gebruiken, maar de gebruikers moeten wel rekening houden met elkaar.</p>
</div>
<div class="section" id="typische-lora-wan-toepassingen">
<h2>Typische LoRa(Wan)-toepassingen<a class="headerlink" href="#typische-lora-wan-toepassingen" title="Permalink naar deze titel">¶</a></h2>
<p>Wat zijn typische LoRa-toepassingen?
Aan welke eisen moeten deze voldoen?</p>
<ul class="simple">
<li>sensoren (en geen actuatoren)</li>
<li>met grote tussenpozen</li>
<li>lage latency niet essentieel</li>
</ul>
<p>Mogelijke voorbeelden:</p>
<ul class="simple">
<li>bewaken van parkeerplaatsen (elke 5 min?)</li>
<li>logistiek: waar is mijn xxx? (elke 5 min?)</li>
<li>smart agriculture (bijv. koeien in Afrika; eigenschappen van gewassen, grond)</li>
<li></li>
</ul>
<p>Met andere woorden: LoRa is <em>niet geschikt voor</em>:</p>
<ul class="simple">
<li>home control (zoals Philips Hue)</li>
</ul>
<p>Belangrijke eigenschappen van LoRa(Wan) voor IoT-toepassingen:</p>
<ul class="simple">
<li>long range (1 km of meer)</li>
<li>low power</li>
<li><dl class="first docutils">
<dt>low cost</dt>
<dd><ul class="first last">
<li>voor 20-30 euro kun je een LoRaWan-IoT-knoop maken</li>
<li>voor 300-500 euro heb je een LoRaWan gateway</li>
</ul>
</dd>
</dl>
</li>
</ul>
<p class="rubric">LoRaWan en TheThingsNetwork</p>
<p><em>LoRaWan</em> is een netwerkprotocol op basis van LoRa.
Een typisch LoRaWan-netwerk bestaat (naast de LoRa-IoT-knopen) uit één of meer <em>gateways</em>,
die verbonden zijn met een <em>server</em>.
Deze server coördineert het verkeer van en naar de gateways,
en zorgt voor de interactie met de rest van het internet.</p>
<p>Je kunt een gateway in dit verband vergelijken met een mobiele zendmast:
deze zorgt voor het verkeer tussen de (mobiele) IoT-knopen en de rest van het netwerk.
Overigens kan een bericht van een IoT-knoop door meerdere gateways ontvangen worden.</p>
<p>Er zijn verschillende aanbieders met een eigen LoRaWan-netwerk,
in Nederland onder andere KPN.</p>
<p>Een bijzondere aanbieder is TheThingsNetwork:
dit netwerk is georganiseerd rond een <em>community</em> van individuen, groepen en bedrijven,
die hun eigen gateways aanbieden voor dit netwerk.
Iedereen kan in deze community meedoen, en gratis deze infrastructuur gebruiken.</p>
<p class="rubric">gateways</p>
<p class="rubric">TTN-server</p>
<p class="rubric">TTN - Fair use regels</p>
<p>Er zijn wel enkele regels voor het eerlijk gebruik (“fair use”):
één van die regels is dat een radio niet meer dan 30 seconden per dag mag zenden.
Op die manier geef je de andere IoT-knopen ook de gelegenheid om het netwerk te gebruiken.</p>
<p>Je kunt de tijd die een radio (van een IoT-knoop) zendt beperken door:</p>
<ul class="simple">
<li>korte berichten te versturen, van enkele bytes;</li>
<li>het aantal berichten per uur te beperken (tot 10-20);</li>
<li>waar mogelijk gebruik te maken van een gateway in de buurt.</li>
</ul>
<p>Deze regels zijn ook gunstig voor het verlengen van de batterijduur van de IoT-knoop.</p>
<p class="rubric">LoRaWan-toepassingen</p>
<p>Voor welke toepassingen is LoRaWan geschikt?</p>
<ul class="simple">
<li></li>
<li>veiligheid (security): de communicatie gebruikt “end-to-end encryptie”,
van de IoT-knoop tot de toepassing in de TTN-server.</li>
</ul>
<p>Voor welke toepassingen is LoraWan <em>niet</em> geschikt?</p>
<ul class="simple">
<li>veel berichten per uur;</li>
<li>grote berichten (meer dan een 10-tal bytes);</li>
<li>grote betrouwbaarheid;</li>
</ul>
<p class="rubric">links</p>
<ul class="simple">
<li><a class="reference external" href="https://www.rs-online.com/designspark/eleven-internet-of-things-iot-protocols-you-need-to-know-about">https://www.rs-online.com/designspark/eleven-internet-of-things-iot-protocols-you-need-to-know-about</a></li>
</ul>
</div>
<div class="section" id="links">
<h2>Links<a class="headerlink" href="#links" title="Permalink naar deze titel">¶</a></h2>
<ul class="simple">
<li><a class="reference external" href="https://en.wikipedia.org/wiki/LoRa">https://en.wikipedia.org/wiki/LoRa</a></li>
<li><a class="reference external" href="https://www.thethingsnetwork.org">https://www.thethingsnetwork.org</a></li>
<li><a class="reference external" href="https://docs.google.com/spreadsheets/d/1QvcKsGeTTPpr9icj4XkKXq4r2zTc2j0gsHLrnplzM3I/edit#gid=0">spreadsheet voor berekenen van LoRaWan airtime</a></li>
<li><a class="reference external" href="https://zakelijkforum.kpn.com/lora-forum-16/welcome-to-the-kpn-lora-forum-an-overview-11123">https://zakelijkforum.kpn.com/lora-forum-16/welcome-to-the-kpn-lora-forum-an-overview-11123</a></li>
</ul>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">iot-0</a></h1>








<h3>Navigatie</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../ten-geleide.html">Ten geleide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../voorbereiding.html">Voorbereiding</a></li>
<li class="toctree-l1"><a class="reference internal" href="../inleiding.html">Inleiding</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bouwstenen.html">Bouwstenen</a></li>
<li class="toctree-l1"><a class="reference internal" href="../webserver.html">Webserver-knopen</a></li>
<li class="toctree-l1"><a class="reference internal" href="../wifi.html">WiFi-MQTT-knopen</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rfm69.html">RFM69-knopen</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../lora.html">LoRa-knopen</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">LoRaWan-keten</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#lora-radio">LoRa-radio</a></li>
<li class="toctree-l3"><a class="reference internal" href="#lorawan">LoRaWan</a></li>
<li class="toctree-l3"><a class="reference internal" href="#thethingsnetwork">TheThingsNetwork</a></li>
<li class="toctree-l3"><a class="reference internal" href="#typische-lora-wan-toepassingen">Typische LoRa(Wan)-toepassingen</a></li>
<li class="toctree-l3"><a class="reference internal" href="#links">Links</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="opdrachten.html">Opdrachten</a></li>
<li class="toctree-l2"><a class="reference internal" href="toetsvragen.html">Toetsvragen</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../todo.html">ToDo</a></li>
</ul>
<p class="caption"><span class="caption-text">Andere modules</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://eelcodijkstra.github.io/com-0/">Com-0</a></li>
<li class="toctree-l1"><a class="reference external" href="https://eelcodijkstra.github.io/iot-1/">IoT-1</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="../lora.html">LoRa-knopen</a><ul>
      <li>Previous: <a href="../lora.html" title="vorig hoofdstuk">LoRa-knopen</a></li>
      <li>Next: <a href="opdrachten.html" title="volgend hoofdstuk">Opdrachten</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Snel zoeken</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Zoek" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018, SLO.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.7.5</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="../_sources/lora/lorawan-keten.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>